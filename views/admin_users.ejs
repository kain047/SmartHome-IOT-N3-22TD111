<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Qu·∫£n l√Ω ng∆∞·ªùi d√πng</title>
  <link rel="stylesheet" href="/css/main.css">
  <script type="module" src="/js/aurora.js"></script>
</head>

<body>
  <div class="aurora-bg"></div>
  <a href="/" class="btn-home">üè† Trang ch·ªß</a>

  <main class="main-content">
    <div class="glass history-box">
      <h2 class="history-title">üë§ Qu·∫£n l√Ω ng∆∞·ªùi d√πng</h2>

      <table class="history-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Username</th>
            <th>H·ªç t√™n</th>
            <th>Email</th>
            <th>Role</th>
            <th>Ng√†y t·∫°o</th>
            <th>H√†nh ƒë·ªông</th>
          </tr>
        </thead>
        <tbody>
          <% users.forEach(u => { %>
            <tr>
              <td><%= u.UserID %></td>
              <td><%= u.Username %></td>
              <td><%= u.FullName %></td>
              <td><%= u.Email %></td>
              <td><%= u.Role %></td>
              <td><%= new Date(u.CreatedDate).toLocaleString("vi-VN") %></td>
              <td>
                <button class="btn btn-danger btn-delete" data-id="<%= u.UserID %>">X√≥a</button>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  </main>

<script>
document.querySelectorAll(".btn-delete").forEach(btn => {
  btn.addEventListener("click", async () => {
    if (!confirm("X√°c nh·∫≠n x√≥a user n√†y?")) return;

    const id = btn.dataset.id;
    const res = await fetch(`/auth/admin/delete-user/${id}`, {
      method: "DELETE"
    });

    if (res.ok) location.reload();
    else alert("Kh√¥ng th·ªÉ x√≥a user!");
  });
});
</script>

</body>
</html>
